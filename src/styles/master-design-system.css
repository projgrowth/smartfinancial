/* =============================================================================
   MASTER DESIGN SYSTEM - Single Source of Truth
   Phase 1: Foundation Consolidation
============================================================================= */

@tailwind base;

@layer base {
  /* ========== ROOT VARIABLES ========== */
  :root {
    /* Refined color system */
    --background: 0 0% 98%;
    --foreground: 215 28% 17%;
    --card: 0 0% 100%;
    --card-foreground: 215 28% 17%;
    --popover: 0 0% 100%;
    --popover-foreground: 215 28% 17%;
    --primary: 215 28% 17%;
    --primary-foreground: 210 40% 98%;
    --secondary: 210 40% 96.1%;
    --secondary-foreground: 215 28% 17%;
    --muted: 210 40% 96.1%;
    --muted-foreground: 215 16% 47%;
    --accent: 210 100% 60%;
    --accent-foreground: 210 40% 98%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;
    --border: 214.3 31.8% 91.4%;
    --input: 214.3 31.8% 91.4%;
    --ring: 210 100% 60%;
    
    /* Layout system */
    --nav-h: 4rem;
    --nav-h-initial: 4rem;
    --radius: 0.5rem;
    --container-narrow: 64rem;
    --container-default: 90rem;
    --container-wide: 96rem;
    --gutter: clamp(1rem, 3vw, 2rem);
    
    /* Animation system */
    --transition-fast: 150ms ease-out;
    --transition-normal: 300ms ease-out;
    --transition-slow: 500ms ease-out;
    --transition-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
    --transition-smooth: cubic-bezier(0.25, 0.1, 0.25, 1.0);
    
    /* Enhanced shadows */
    --shadow-elegant: 0 10px 30px -10px hsl(var(--primary) / 0.15);
    --shadow-glow: 0 0 40px hsl(var(--primary) / 0.2);
    --shadow-premium: 0 25px 50px -12px hsl(var(--primary) / 0.25);
    
    /* Animation timing values */
    --animation-delay-fast: 100ms;
    --animation-delay-normal: 200ms;
    --animation-delay-slow: 400ms;
    --animation-delay-extra-slow: 600ms;
    
    /* Word rotation timing */
    --word-rotation-interval: 3000ms;
    --word-transition-duration: 500ms;
    
    /* Testimonial timing */
    --testimonial-slide-interval: 6000ms;
    --testimonial-pause-duration: 10000ms;
    
    /* Mobile gesture thresholds */
    --swipe-threshold: 80px;
    --swipe-velocity: 0.3;
    --pull-refresh-threshold: 80px;
    --pull-refresh-max: 120px;
    
    /* Error state timing */
    --error-retry-delay: 1000ms;
    --toast-duration: 5000ms;
    --offline-check-interval: 5000ms;
    
    /* Parallax intensity */
    --parallax-intensity-subtle: 0.3;
    --parallax-intensity-medium: 0.5;
    --parallax-intensity-strong: 0.8;
    
    /* Counter animation */
    --counter-duration: 2000ms;
    --counter-steps: 60;
    
    /* Icon size system */
    --icon-xs: 0.75rem;  /* 12px */
    --icon-sm: 1rem;     /* 16px */
    --icon-md: 1.25rem;  /* 20px */
    --icon-lg: 1.5rem;   /* 24px */
    --icon-xl: 1.75rem;  /* 28px */
    --icon-xxl: 2rem;    /* 32px */
    
    /* Border radius system */
    --radius-xs: 0.25rem;
    --radius-sm: 0.375rem;
    --radius-md: 0.5rem;
    --radius-lg: 0.75rem;
    --radius-xl: 1rem;
    --radius-full: 9999px;
    
    /* Enhanced shadow system */
    --shadow-xs: 0 1px 2px 0 hsl(var(--primary) / 0.05);
    --shadow-sm: 0 1px 3px 0 hsl(var(--primary) / 0.1), 0 1px 2px -1px hsl(var(--primary) / 0.1);
    --shadow-md: 0 4px 6px -1px hsl(var(--primary) / 0.1), 0 2px 4px -2px hsl(var(--primary) / 0.1);
    --shadow-lg: 0 10px 15px -3px hsl(var(--primary) / 0.1), 0 4px 6px -4px hsl(var(--primary) / 0.1);
    --shadow-xl: 0 20px 25px -5px hsl(var(--primary) / 0.1), 0 8px 10px -6px hsl(var(--primary) / 0.1);
    
    /* Stagger animation system */
    --stagger-delay-fast: 50ms;
    --stagger-delay-normal: 100ms;
    --stagger-delay-slow: 150ms;
    --stagger-delay-extra-slow: 200ms;
  }

  /* ========== BASE ELEMENT STYLES ========== */
  * {
    @apply border-border;
  }

  html {
    scroll-padding-top: var(--nav-h);
    scroll-behavior: smooth;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
  }

  body {
    @apply bg-background text-foreground font-sans;
    line-height: 1.6;
    touch-action: manipulation;
  }

  h1, h2, h3, h4, h5, h6 {
    @apply font-heading font-medium text-foreground;
  }

  p {
    @apply text-muted-foreground;
    max-width: 70ch;
  }

  a {
    @apply text-accent hover:text-accent/80 transition-colors duration-300;
    text-underline-offset: 0.2em;
  }

  /* Form elements - mobile optimization */
  input, select, textarea {
    @apply rounded-md border border-input focus:border-accent focus:ring-2 focus:ring-accent/20 transition-all duration-200;
    font-size: 16px; /* Prevents zoom on mobile */
  }

  button {
    @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent focus-visible:ring-offset-2;
  }

  /* Better focus styles */
  :focus-visible {
    @apply outline-none ring-2 ring-accent ring-offset-2;
  }

  ::selection {
    @apply bg-accent/20 text-foreground;
  }
}

/* ========== TYPOGRAPHY SCALE ========== */
.heading-display {
  @apply text-4xl md:text-5xl lg:text-6xl xl:text-7xl font-heading font-medium tracking-tight text-foreground;
  line-height: 1.1;
  letter-spacing: -0.02em;
}

.heading-display-fluid {
  font-size: clamp(2.25rem, 4.5vw + 0.75rem, 4.5rem);
  line-height: clamp(1.05, 1 + 0.05vw, 1.08);
  letter-spacing: clamp(-0.03em, -0.025em + -0.005vw, -0.02em);
  @apply font-heading font-medium tracking-tight text-foreground;
  margin-bottom: clamp(1rem, 2.5vw, 1.5rem);
}

.heading-xl {
  @apply text-3xl md:text-4xl lg:text-5xl font-heading font-medium tracking-tight text-foreground;
  line-height: 1.15;
  letter-spacing: -0.015em;
}

.heading-lg {
  @apply text-2xl md:text-3xl lg:text-4xl font-heading font-medium tracking-tight text-foreground;
  line-height: 1.2;
  letter-spacing: -0.01em;
}

.heading-md {
  @apply text-xl md:text-2xl lg:text-3xl font-heading font-medium tracking-tight text-foreground;
  line-height: 1.25;
}

.heading-sm {
  @apply text-lg md:text-xl lg:text-2xl font-heading font-medium tracking-tight text-foreground;
  line-height: 1.3;
}

.text-body-xl {
  @apply text-lg md:text-xl leading-relaxed text-muted-foreground;
  max-width: 65ch;
}

.text-body-lg {
  @apply text-base md:text-lg leading-relaxed text-muted-foreground;
  max-width: 68ch;
}

.text-body {
  @apply text-sm md:text-base leading-relaxed text-muted-foreground;
  max-width: 70ch;
}

.text-body-sm {
  @apply text-xs md:text-sm leading-relaxed text-muted-foreground;
  max-width: 72ch;
}

.heading-xs {
  @apply text-base md:text-lg lg:text-xl font-heading font-medium tracking-tight text-foreground;
  line-height: 1.35;
}

.text-fluid-xl {
  font-size: clamp(1.25rem, 2.5vw + 0.5rem, 2rem);
  line-height: clamp(1.4, 1.35 + 0.05vw, 1.45);
  @apply font-heading font-medium text-foreground;
}

.text-fluid-sm {
  font-size: clamp(0.875rem, 1.5vw + 0.5rem, 1rem);
  line-height: clamp(1.5, 1.45 + 0.05vw, 1.55);
  @apply text-muted-foreground;
}

/* ========== CONTAINER SYSTEM ========== */
.container-site,
.container-unified {
  width: 100%;
  max-width: var(--container-default);
  margin-left: auto;
  margin-right: auto;
  padding-left: var(--gutter);
  padding-right: var(--gutter);
}

.container-narrow {
  width: 100%;
  max-width: var(--container-narrow);
  margin-left: auto;
  margin-right: auto;
  padding-left: var(--gutter);
  padding-right: var(--gutter);
}

.container-wide {
  width: 100%;
  max-width: var(--container-wide);
  margin-left: auto;
  margin-right: auto;
  padding-left: var(--gutter);
  padding-right: var(--gutter);
}

/* ========== SPACING SYSTEM ========== */
.section-xl {
  @apply py-20 md:py-32;
}

.section-lg {
  @apply py-16 md:py-24;
}

.section-md {
  @apply py-12 md:py-20;
}

.section-sm {
  @apply py-8 md:py-16;
}

.gap-site-xl,
.gap-unified-xl {
  @apply gap-8 md:gap-12;
}

.gap-site-lg,
.gap-unified-lg {
  @apply gap-6 md:gap-8;
}

.gap-site-md,
.gap-unified-md {
  @apply gap-4 md:gap-6;
}

.space-site-lg,
.space-component-lg {
  @apply space-y-8 md:space-y-12;
}

.space-site-md,
.space-component-md {
  @apply space-y-6 md:space-y-8;
}

.space-component-sm {
  @apply space-y-4 md:space-y-6;
}

.space-component-xs {
  @apply space-y-2 md:space-y-3;
}

/* ========== BUTTON SYSTEM ========== */
.btn-primary {
  @apply inline-flex items-center justify-center font-medium transition-all duration-300 
         focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2
         min-h-[44px] min-w-[44px] rounded-md px-6 py-3 bg-primary text-primary-foreground 
         hover:bg-primary/90 active:scale-[0.98];
}

.btn-secondary {
  @apply inline-flex items-center justify-center font-medium transition-all duration-300
         focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2
         min-h-[44px] min-w-[44px] rounded-md px-6 py-3 bg-secondary text-secondary-foreground
         hover:bg-secondary/80 active:scale-[0.98];
}

.btn-outline {
  @apply inline-flex items-center justify-center font-medium transition-all duration-300
         focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2
         min-h-[44px] min-w-[44px] rounded-md px-6 py-3 border border-input bg-background
         hover:bg-accent hover:text-accent-foreground active:scale-[0.98];
}

/* ========== GRID SYSTEM ========== */
.grid-auto {
  @apply grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3;
}

.grid-two-col {
  @apply grid grid-cols-1 md:grid-cols-2;
}

.grid-three-col {
  @apply grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3;
}

.grid-four-col {
  @apply grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4;
}

/* ========== CARD SYSTEM ========== */
.card-equal-height {
  @apply h-full flex flex-col;
}

.card-content-grow {
  @apply flex-grow;
}

/* ========== INTERACTION & ACCESSIBILITY SYSTEM ========== */
.scroll-smooth-enhanced {
  scroll-behavior: smooth;
  -webkit-overflow-scrolling: touch;
}

.scroll-momentum {
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
}

.safari-scroll-container {
  -webkit-overflow-scrolling: touch;
  overscroll-behavior-y: contain;
}

.touch-pan-y {
  touch-action: pan-y;
}

.touch-target {
  @apply min-h-[44px] min-w-[44px];
}

.touch-target-lg {
  @apply min-h-[48px] min-w-[48px];
}

.focus-enhanced {
  @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent focus-visible:ring-offset-2 transition-all duration-200;
}

.bg-noise {
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.4'/%3E%3C/svg%3E");
  background-size: 180px 180px;
  opacity: 0.035;
}

/* ========== ENHANCED GRADIENT SYSTEM ========== */
.gradient-primary {
  background: linear-gradient(135deg, hsl(var(--primary)), hsl(var(--primary)) 70%, hsl(var(--accent)/0.8));
}

.gradient-secondary {
  background: linear-gradient(135deg, hsl(var(--secondary)), hsl(var(--muted)));
}

.gradient-accent-soft {
  background: linear-gradient(135deg, hsl(var(--accent)/0.05), hsl(var(--background)), hsl(var(--accent)/0.1));
}

.gradient-accent-medium {
  background: linear-gradient(135deg, hsl(var(--accent)/0.1), hsl(var(--background)), hsl(var(--accent)/0.15));
}

.gradient-charcoal {
  background: linear-gradient(135deg, hsl(215 28% 17%), hsl(215 28% 14%));
}

.gradient-charcoal-dark {
  background: linear-gradient(135deg, hsl(215 28% 14%), hsl(215 28% 10%));
}

.gradient-overlay-light {
  background: linear-gradient(135deg, hsl(var(--background)/0.9), hsl(var(--background)/0.95));
}

.gradient-overlay-dark {
  background: linear-gradient(135deg, hsl(var(--foreground)/0.1), hsl(var(--foreground)/0.05));
}

.gradient-text {
  background: linear-gradient(135deg, hsl(var(--primary)), hsl(var(--accent)));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

/* ========== ENHANCED SHADOW SYSTEM ========== */
.shadow-design-xs {
  box-shadow: var(--shadow-xs);
}

.shadow-design-sm {
  box-shadow: var(--shadow-sm);
}

.shadow-design-md {
  box-shadow: var(--shadow-md);
}

.shadow-design-lg {
  box-shadow: var(--shadow-lg);
}

.shadow-design-xl {
  box-shadow: var(--shadow-xl);
}

.shadow-elegant {
  box-shadow: var(--shadow-elegant);
}

.shadow-glow {
  box-shadow: var(--shadow-glow);
}

.shadow-premium {
  box-shadow: var(--shadow-premium);
}

/* Hover shadow states */
.hover\:shadow-elegant:hover {
  box-shadow: var(--shadow-elegant);
}

.hover\:shadow-glow:hover {
  box-shadow: var(--shadow-glow);
}

.hover\:shadow-premium:hover {
  box-shadow: var(--shadow-premium);
}

/* ========== ENHANCED ANIMATION SYSTEM ========== */
/* Icon size utilities */
.icon-xs {
  width: var(--icon-xs);
  height: var(--icon-xs);
}

.icon-sm {
  width: var(--icon-sm);
  height: var(--icon-sm);
}

.icon-md {
  width: var(--icon-md);
  height: var(--icon-md);
}

.icon-lg {
  width: var(--icon-lg);
  height: var(--icon-lg);
}

.icon-xl {
  width: var(--icon-xl);
  height: var(--icon-xl);
}

.icon-xxl {
  width: var(--icon-xxl);
  height: var(--icon-xxl);
}

/* Transition duration utilities */
.transition-fast {
  transition-duration: var(--transition-fast);
}

.transition-normal {
  transition-duration: var(--transition-normal);
}

.transition-slow {
  transition-duration: var(--transition-slow);
}

/* Micro-interactions */
.hover-lift {
  transition: all var(--transition-normal) ease-out;
  transform-origin: center;
}

.hover-lift:hover {
  transform: scale(1.05);
  box-shadow: var(--shadow-lg);
}

.hover-lift:active {
  transform: scale(0.95);
}

.hover-glow {
  transition: all var(--transition-normal);
}

.hover-glow:hover {
  box-shadow: var(--shadow-xl), 0 0 40px hsl(var(--primary) / 0.2);
}

.spring-bounce {
  transition: transform var(--transition-fast) var(--transition-spring);
}

.spring-bounce:hover {
  transform: scale(1.05);
}

.spring-bounce:active {
  transform: scale(0.98);
}

/* Stagger animation utilities */
.stagger-1 {
  animation-delay: calc(1 * var(--stagger-delay-normal));
}

.stagger-2 {
  animation-delay: calc(2 * var(--stagger-delay-normal));
}

.stagger-3 {
  animation-delay: calc(3 * var(--stagger-delay-normal));
}

.stagger-4 {
  animation-delay: calc(4 * var(--stagger-delay-normal));
}

.stagger-5 {
  animation-delay: calc(5 * var(--stagger-delay-normal));
}

.stagger-6 {
  animation-delay: calc(6 * var(--stagger-delay-normal));
}

/* Enhanced shimmer effect */
.shimmer-gradient {
  background: linear-gradient(
    90deg,
    transparent,
    rgba(255, 255, 255, 0.4),
    transparent
  );
  background-size: 200% 100%;
}

/* Testimonial progress animation */
@keyframes testimonial-progress {
  0% { width: 0%; }
  100% { width: 100%; }
}

.word-rotator {
  position: relative;
  display: inline-block;
  vertical-align: baseline;
}

.word-layer {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  text-align: center;
}

.word-enter {
  animation: word-enter var(--transition-slow) ease-out;
}

.word-exit {
  animation: word-exit var(--transition-normal) ease-out;
}

@keyframes word-enter {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes word-exit {
  from {
    opacity: 1;
    transform: translateY(0);
  }
  to {
    opacity: 0;
    transform: translateY(-8px);
  }
}

/* ========== ACCESSIBILITY & REDUCED MOTION ========== */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
  
  .word-enter, .word-exit {
    animation: none;
  }
}

/* ========== MOBILE OPTIMIZATIONS ========== */
@media screen and (max-width: 768px) {
  input, select, textarea {
    font-size: 16px; /* Prevent zoom */
  }
  
  .btn-primary, .btn-secondary, .btn-outline {
    @apply min-h-[48px]; /* Larger touch targets */
  }
}

/* ========== SAFARI OPTIMIZATIONS ========== */
@supports (-webkit-appearance: none) {
  html {
    -webkit-overflow-scrolling: touch;
  }
  
  body {
    -webkit-font-smoothing: antialiased;
  }
}